"""
ููู ุงูุฅุนุฏุงุฏุงุช ุงููุฑูุฒู ูููุดุฑูุน
ูุญุชูู ุนูู ุฌููุน ุงูุซูุงุจุช ูุงูุฅุนุฏุงุฏุงุช ุงููุงุจูุฉ ููุชุฎุตูุต
"""
import os
from dataclasses import dataclass
from typing import Dict

# =============================================================================
# ุฅุนุฏุงุฏุงุช ุงูุชูููุฌุฑุงู
# =============================================================================
TELEGRAM_TOKEN = os.getenv("TELEGRAM_TOKEN", "")
TELEGRAM_CHAT_ID = os.getenv("TELEGRAM_CHAT_ID", "")

# =============================================================================
# ุฅุนุฏุงุฏุงุช ุงููููุน
# =============================================================================
BASE_URL = "https://almusbahlight.com"
CATEGORY_URL = f"{BASE_URL}/categories/888805/%D8%AB%D8%B1%D9%8A%D8%A7%D8%AA-%D9%83%D8%B1%D9%8A%D8%B3%D8%AA%D8%A7%D9%84"

# =============================================================================
# ุฅุนุฏุงุฏุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช
# =============================================================================
DB_FILE = "products.db"
DB_BACKUP_DIR = "backups"

# =============================================================================
# ุฅุนุฏุงุฏุงุช ุงูุณูุฑุงุจุฑ
# =============================================================================
REQUEST_TIMEOUT = 20  # ุซุงููุฉ
RETRY_ATTEMPTS = 3
RETRY_DELAY = 2  # ุซุงููุฉ
PAGE_DELAY = 1  # ุชุฃุฎูุฑ ุจูู ุงูุตูุญุงุช
MAX_PAGES = 50  # ุญุฏ ุฃูุตู ููุตูุญุงุช ูุชุฌูุจ ุงูููุจุงุช ุงููุงููุงุฆูุฉ

USER_AGENTS = [
    'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36',
    'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36',
    'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:121.0) Gecko/20100101 Firefox/121.0',
]

# =============================================================================
# ุฑุณุงุฆู ุงูุชูุจููุงุช (ูุน ุชูุณูู HTML)
# =============================================================================

@dataclass
class MessageTemplates:
    """ููุงูุจ ุฑุณุงุฆู ุงูุชูุจููุงุช"""

    NEW_PRODUCT = """
๐ <b>ููุชุฌ ุฌุฏูุฏ ุชู ุฅุถุงูุชู!</b>
โโโโโโโโโโโโโโโโโโโโ
๐ฆ <b>ุงูุงุณู:</b> {name}
๐ฐ <b>ุงูุณุนุฑ:</b> {price}
๐ <b>ุงูุฑุงุจุท:</b> <a href="{url}">ุนุฑุถ ุงูููุชุฌ</a>
โโโโโโโโโโโโโโโโโโโโ
โฐ <i>ุชู ุงูุงูุชุดุงู: {timestamp}</i>
"""

    OUT_OF_STOCK = """
โ๏ธ <b>ุชูุจูู ููุงุฏ ูููุฉ!</b>
โโโโโโโโโโโโโโโโโโโโ
๐ฆ <b>ุงูุงุณู:</b> {name}
๐ฐ <b>ุงูุณุนุฑ:</b> {price}
โ <b>ุงูุญุงูุฉ:</b> ุงูููุชุฌ ุฃุตุจุญ ุบูุฑ ูุชููุฑ
๐ <b>ุงูุฑุงุจุท:</b> <a href="{url}">ุนุฑุถ ุงูููุชุฌ</a>
โโโโโโโโโโโโโโโโโโโโ
โฐ <i>ุชู ุงูุงูุชุดุงู: {timestamp}</i>
"""

    BACK_IN_STOCK = """
โ <b>ุชููุฑ ุงูููุชุฌ ูู ุฌุฏูุฏ!</b>
โโโโโโโโโโโโโโโโโโโโ
๐ฆ <b>ุงูุงุณู:</b> {name}
๐ฐ <b>ุงูุณุนุฑ:</b> {price}
๐ <b>ุงูุญุงูุฉ:</b> ุงูููุชุฌ ุฃุตุจุญ ูุชููุฑุงู ุงูุขู
๐ <b>ุงูุฑุงุจุท:</b> <a href="{url}">ุนุฑุถ ุงูููุชุฌ</a>
โโโโโโโโโโโโโโโโโโโโ
โฐ <i>ุชู ุงูุงูุชุดุงู: {timestamp}</i>
"""

    DELETED = """
๐๏ธ <b>ุชูุจูู ุญุฐู ููุชุฌ!</b>
โโโโโโโโโโโโโโโโโโโโ
๐ฆ <b>ุงูุงุณู:</b> {name}
๐ฐ <b>ุงูุณุนุฑ ุงูุฃุฎูุฑ:</b> {price}
โ๏ธ <b>ุงูุญุงูุฉ:</b> ุชู ุญุฐู ุงูููุชุฌ ููุงุฆูุงู ูู ุงููุชุฌุฑ
๐ <b>ุงูุฑุงุจุท:</b> <a href="{url}">ุงูุฑุงุจุท ุงููุญุฐูู</a>
โโโโโโโโโโโโโโโโโโโโ
โฐ <i>ุชู ุงูุงูุชุดุงู: {timestamp}</i>
"""

    PRICE_CHANGE = """
๐ฐ <b>ุชุบููุฑ ูู ุงูุณุนุฑ!</b>
โโโโโโโโโโโโโโโโโโโโ
๐ฆ <b>ุงูุงุณู:</b> {name}
๐ <b>ุงูุณุนุฑ ุงููุฏูู:</b> {old_price}
๐ <b>ุงูุณุนุฑ ุงูุฌุฏูุฏ:</b> {new_price}
{price_emoji} <b>ุงููุฑู:</b> {price_diff}
๐ <b>ุงูุฑุงุจุท:</b> <a href="{url}">ุนุฑุถ ุงูููุชุฌ</a>
โโโโโโโโโโโโโโโโโโโโ
โฐ <i>ุชู ุงูุงูุชุดุงู: {timestamp}</i>
"""

    SUMMARY_REPORT = """
๐ <b>ุชูุฑูุฑ ุงููุญุต ุงูุฏูุฑู</b>
โโโโโโโโโโโโโโโโโโโโ
๐ <b>ุงูุชุงุฑูุฎ:</b> {timestamp}
๐ <b>ุงููุณู:</b> ุซุฑูุงุช ูุฑูุณุชุงู ุฃูุฑูุจู

<b>๐ ุงูุฅุญุตุงุฆูุงุช:</b>
โข ุฅุฌูุงูู ุงูููุชุฌุงุช: {total}
โข ุงููุชููุฑุฉ: {available}
โข ุบูุฑ ุงููุชููุฑุฉ: {out_of_stock}

<b>๐ ุงูุชุบููุฑุงุช ุงูููุชุดูุฉ:</b>
โข ููุชุฌุงุช ุฌุฏูุฏุฉ: {new}
โข ููุงุฏ ูููุฉ: {went_out}
โข ุนูุฏุฉ ุชููุฑ: {back_in}
โข ููุชุฌุงุช ูุญุฐููุฉ: {deleted}
โข ุชุบููุฑุงุช ุฃุณุนุงุฑ: {price_changes}

โโโโโโโโโโโโโโโโโโโโ
{status_message}
"""

# =============================================================================
# ุฅุนุฏุงุฏุงุช ุงูุณุฌูุงุช (Logging)
# =============================================================================
LOG_FORMAT = '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
LOG_FILE = 'monitor.log'
LOG_LEVEL = 'INFO'

# =============================================================================
# ุชุญูู ูู ุตุญุฉ ุงูุฅุนุฏุงุฏุงุช
# =============================================================================
def validate_config() -> Dict[str, bool]:
    """ุงูุชุญูู ูู ุตุญุฉ ุงูุฅุนุฏุงุฏุงุช ุงูุฃุณุงุณูุฉ"""
    checks = {
        "telegram_token": bool(TELEGRAM_TOKEN),
        "telegram_chat_id": bool(TELEGRAM_CHAT_ID),
        "category_url": bool(CATEGORY_URL),
    }
    return checks

def is_config_valid() -> bool:
    """ูู ุงูุฅุนุฏุงุฏุงุช ุตุญูุญุฉุ"""
    checks = validate_config()
    return all(checks.values())
